// Copyright (c) 2021 Terminus, Inc.
//
// This program is free software: you can use, redistribute, and/or modify
// it under the terms of the GNU Affero General Public License, version 3
// or later ("AGPL"), as published by the Free Software Foundation.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE.
//
// You should have received a copy of the GNU Affero General Public License
// along with this program. If not, see <http://www.gnu.org/licenses/>.

import { createFlatStore } from 'app/cube';
import { isEmpty } from 'lodash';
import traceConvert from 'msp/monitor/trace-insight/common/utils/traceConvert';
import { getTraceCount, getTraceSummary, getSpanDetailContent, getTraceDetailContent } from '../services/trace';

interface IState {
  traceCount: any;
  traceSummary: MS_MONITOR.ITraceSummary[];
  spanDetailContent: any;
  traceDetailContent: any;
}

const initState: IState = {
  traceCount: {} as any,
  traceSummary: [],
  spanDetailContent: {
    visible: false,
    span: {},
  } as any,
  traceDetailContent: {} as any,
};

const transformTrace = (trace: MONITOR_TRACE.ITrace) => {
  if (isEmpty(trace)) return {};
  const traceDetail = traceConvert(trace);
  traceDetail.spans.forEach((i) => {
    // eslint-disable-next-line
    i.isExpand = i.isShow = true;
  });
  return traceDetail;
};

const trace = createFlatStore({
  name: 'monitorTraceStore',
  state: initState,
  effects: {
    async getTraceCount(
      { call, update, getParams },
      payload: Omit<MS_MONITOR.ITraceCountQuery, 'cardinality' | 'align' | 'filter_fields.terminus_keys'>,
    ) {
      const { terminusKey } = getParams();
      const traceCount = await call(getTraceCount, {
        cardinality: 'tags.trace_id',
        align: false,
        'filter_fields.terminus_keys': terminusKey,
        ...payload,
      });
      update({ traceCount });
    },
    async getTraceSummary({ call, update, getParams }, payload: Omit<MS_MONITOR.ITraceSummaryQuery, 'scopeId'>) {
      const { terminusKey } = getParams();
      const traceSummary = await call(getTraceSummary, { scopeId: terminusKey, ...payload });
      update({ traceSummary });
    },
    async getSpanDetailContent({ call, update }, payload: any) {
      const response = await call(getSpanDetailContent, payload);
      const annotations = response.span.annotations || [];
      // 接口返回timestamp为毫秒，duration为微秒，统一为微秒
      const spanDetailContent = {
        ...response,
        annotations: annotations.map((item: any) => {
          return { ...item, timestamp: item.timestamp * 1000 };
        }),
      };
      update({ spanDetailContent });
    },
    async getTraceDetailContent({ call, update, getParams }, payload: Omit<MONITOR_TRACE.IQuerySpan, 'scopeId'>) {
      const { terminusKey } = getParams();
      // const response = await call(getTraceDetailContent, { ...payload, scopeId: terminusKey });
      const response = {
        spans: [
          {
            id: '277abf79-903b-4a17-bb70-8da66eece3fb',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/accept',
            startTime: 1630475277006422300,
            endTime: 1630475277006427400,
            parentSpanId: 'd2d57386-9901-4870-bb0a-36e8989145c9',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'd2d57386-9901-4870-bb0a-36e8989145c9',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '277abf79-903b-4a17-bb70-8da66eece3fb',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 5085,
          },
          {
            id: '61296321-3b8c-47b2-849c-f43dd780f26b',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/onComplete',
            startTime: 1630475277005286400,
            endTime: 1630475277005291000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '61296321-3b8c-47b2-849c-f43dd780f26b',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 4509,
          },
          {
            id: '7f481808-241d-4af7-a282-344008e685f9',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PUBLISH/writeToChannelAndFlush',
            startTime: 1630475277014715400,
            endTime: 1630475277014759700,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'PUBLISH',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PUBLISH/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '7f481808-241d-4af7-a282-344008e685f9',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 44350,
          },
          {
            id: 'f5d8276d-0adb-48ff-8e66-585d659c88ca',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/accept',
            startTime: 1630475277014606000,
            endTime: 1630475277014612500,
            parentSpanId: 'a139dd7c-4e93-4063-bf75-9876cea2444c',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'a139dd7c-4e93-4063-bf75-9876cea2444c',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'f5d8276d-0adb-48ff-8e66-585d659c88ca',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6401,
          },
          {
            id: '25f7a5c6-7951-42d0-9ffb-f1545aac30ad',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/onComplete',
            startTime: 1630475277013820200,
            endTime: 1630475277013822200,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '25f7a5c6-7951-42d0-9ffb-f1545aac30ad',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1972,
          },
          {
            id: 'f301a21c-75df-49c1-8a8a-a9b07a420218',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/APPEND/onComplete',
            startTime: 1630475277012488700,
            endTime: 1630475277012490500,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/APPEND/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'f301a21c-75df-49c1-8a8a-a9b07a420218',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1642,
          },
          {
            id: '7c4c9d3e-bf2e-444b-bec0-248d22a09f9b',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/accept',
            startTime: 1630475277012114700,
            endTime: 1630475277012121900,
            parentSpanId: 'b0e4d1a0-7cba-40f8-a49a-1721111a72ac',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'b0e4d1a0-7cba-40f8-a49a-1721111a72ac',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '7c4c9d3e-bf2e-444b-bec0-248d22a09f9b',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 7129,
          },
          {
            id: '74c295f3-00f3-4f37-b21d-4b8423fce1fd',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/APPEND/accept',
            startTime: 1630475277013795800,
            endTime: 1630475277013801200,
            parentSpanId: 'f301a21c-75df-49c1-8a8a-a9b07a420218',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/APPEND/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'f301a21c-75df-49c1-8a8a-a9b07a420218',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '74c295f3-00f3-4f37-b21d-4b8423fce1fd',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 5466,
          },
          {
            id: '6db72300-ad52-4409-9778-438f0e0c4454',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/writeToChannelAndFlush',
            startTime: 1630475277010786800,
            endTime: 1630475277010832000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'GET',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '6db72300-ad52-4409-9778-438f0e0c4454',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 44876,
          },
          {
            id: '39e69530-1a19-46dd-a3a5-729ef576a974',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/APPEND/writeToChannelAndFlush',
            startTime: 1630475277012526800,
            endTime: 1630475277013566200,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'APPEND',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/APPEND/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '39e69530-1a19-46dd-a3a5-729ef576a974',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1039375,
          },
          {
            id: 'cb2f333d-74fa-4eb0-b30f-e079dac5fe67',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/HMSET/onComplete',
            startTime: 1630475277011765200,
            endTime: 1630475277011767600,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/HMSET/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'cb2f333d-74fa-4eb0-b30f-e079dac5fe67',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2246,
          },
          {
            id: 'd0285187-314b-4e71-9965-1f3294f5b651',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Mysql/PreparedStatement/execute',
            startTime: 1630475277007110700,
            endTime: 1630475277008586000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Mysql',
              db_instance: 'erda',
              db_statement:
                'SELECT                 id,                 `user_id`, `client_id`, `client_name`, `client_secret`, `access_token_validity`,        `access_token_validity_seconds`, `additional_information`, `authorities`, `authorized_grant_types`,        `auto_approve_scopes`, `refresh_token_validity`, `refresh_token_validity_seconds`,        `registered_redirect_uris`, `resource_ids`, `scope`, `enabled`, `deleted`,`app_level`,`sensitived`,`alter_notify_url`, `created_at`, `updated_at`                  FROM                 uc_client_details                       WHERE `deleted` = 0                        AND `client_id` = ?              ORDER BY `id` DESC',
              db_type: 'Mysql',
              host: 'mysql-master.group-addon-mysql--ne669b2f5aed84820b10c330578a93e18.svc.cluster.local:3306',
              host_ip: '10.0.6.220',
              operation_name: 'Mysql/PreparedStatement/execute',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_hostname: 'mysql-master.group-addon-mysql--ne669b2f5aed84820b10c330578a93e18.svc.cluster.local:3306',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'd0285187-314b-4e71-9965-1f3294f5b651',
              span_kind: 'client',
              span_layer: 'db',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1475330,
          },
          {
            id: 'd2d57386-9901-4870-bb0a-36e8989145c9',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/onComplete',
            startTime: 1630475277006041000,
            endTime: 1630475277006044000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'd2d57386-9901-4870-bb0a-36e8989145c9',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2833,
          },
          {
            id: 'fa1250d7-f07a-48f6-bda0-56e747fed333',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/writeToChannelAndFlush',
            startTime: 1630475277005406000,
            endTime: 1630475277005469700,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'GET',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'fa1250d7-f07a-48f6-bda0-56e747fed333',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 63626,
          },
          {
            id: 'eb9d7976-e6ba-488a-9b04-86274aa1d32d',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/writeToChannelAndFlush',
            startTime: 1630475277006105000,
            endTime: 1630475277006139600,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'GET',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'eb9d7976-e6ba-488a-9b04-86274aa1d32d',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 34502,
          },
          {
            id: '2dfdb73e-8824-4d5f-9512-42102a6d8021',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
            startTime: 1630475277013875500,
            endTime: 1630475277013918700,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'PEXPIRE',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '2dfdb73e-8824-4d5f-9512-42102a6d8021',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 43182,
          },
          {
            id: 'fcdd7bb4-c66a-4686-8b8f-e642a5397280',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
            startTime: 1630475277013281000,
            endTime: 1630475277013324300,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'PEXPIRE',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'fcdd7bb4-c66a-4686-8b8f-e642a5397280',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 43205,
          },
          {
            id: 'a139dd7c-4e93-4063-bf75-9876cea2444c',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/onComplete',
            startTime: 1630475277013230600,
            endTime: 1630475277013232400,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'a139dd7c-4e93-4063-bf75-9876cea2444c',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1858,
          },
          {
            id: 'b3617e13-1184-42fd-b6c0-5a7dd76fe8eb',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/accept',
            startTime: 1630475277012670700,
            endTime: 1630475277012676900,
            parentSpanId: 'ae205324-7b61-4388-a19e-7b76c0b82ce6',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'ae205324-7b61-4388-a19e-7b76c0b82ce6',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'b3617e13-1184-42fd-b6c0-5a7dd76fe8eb',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6048,
          },
          {
            id: '787bfde9-8c67-46d4-befa-6bcf9f948489',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Mysql/PreparedStatement/execute',
            startTime: 1630475277008998100,
            endTime: 1630475277008504600,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Mysql',
              db_instance: 'erda',
              db_statement:
                'SELECT                 id,                 `user_id`, `client_id`, `client_name`, `client_secret`, `access_token_validity`,        `access_token_validity_seconds`, `additional_information`, `authorities`, `authorized_grant_types`,        `auto_approve_scopes`, `refresh_token_validity`, `refresh_token_validity_seconds`,        `registered_redirect_uris`, `resource_ids`, `scope`, `enabled`, `deleted`,`app_level`,`sensitived`,`alter_notify_url`, `created_at`, `updated_at`                  FROM                 uc_client_details                       WHERE `deleted` = 0                        AND `client_id` = ?              ORDER BY `id` DESC',
              db_type: 'Mysql',
              host: 'mysql-master.group-addon-mysql--ne669b2f5aed84820b10c330578a93e18.svc.cluster.local:3306',
              host_ip: '10.0.6.220',
              operation_name: 'Mysql/PreparedStatement/execute',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_hostname: 'mysql-master.group-addon-mysql--ne669b2f5aed84820b10c330578a93e18.svc.cluster.local:3306',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '787bfde9-8c67-46d4-befa-6bcf9f948489',
              span_kind: 'client',
              span_layer: 'db',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 493638,
          },
          {
            id: 'cda980bf-d37e-463f-b880-de594ed2d8b0',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/onComplete',
            startTime: 1630475277012141000,
            endTime: 1630475277012142800,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'cda980bf-d37e-463f-b880-de594ed2d8b0',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 1873,
          },
          {
            id: 'a7a0a1a7-0fa8-4682-a7ef-e8b3a4954116',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/writeToChannelAndFlush',
            startTime: 1630475277011373800,
            endTime: 1630475277011422000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'SADD',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'a7a0a1a7-0fa8-4682-a7ef-e8b3a4954116',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 48168,
          },
          {
            id: 'e0cc2514-57ce-42dc-a5f0-0338203c242d',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/HMSET/accept',
            startTime: 1630475277011246800,
            endTime: 1630475277011253200,
            parentSpanId: 'cb2f333d-74fa-4eb0-b30f-e079dac5fe67',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/HMSET/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'cb2f333d-74fa-4eb0-b30f-e079dac5fe67',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'e0cc2514-57ce-42dc-a5f0-0338203c242d',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6312,
          },
          {
            id: 'f1ee894c-2ab4-4e8f-ba75-2738a522c894',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/onComplete',
            startTime: 1630475277010719500,
            endTime: 1630475277010722000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'f1ee894c-2ab4-4e8f-ba75-2738a522c894',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2721,
          },
          {
            id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'GET http://uc:8080/api/open/v1/users/1103',
            startTime: 1630475277005956600,
            endTime: 1630475277014476800,
            parentSpanId: '',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'SpringBoot',
              host: 'uc:8080',
              host_ip: '10.0.6.220',
              http_method: 'GET',
              http_path: '/api/open/v1/users/1103',
              http_status_code: '200',
              http_url: 'http://uc:8080/api/open/v1/users/1103',
              operation_name: 'GET http://uc:8080/api/open/v1/users/1103',
              org_id: '100060',
              org_name: 'terminus',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              span_kind: 'server',
              span_layer: 'http',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 8520351,
          },
          {
            id: 'ac8b0445-dcb1-4afe-b369-8d8070bb36f9',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/accept',
            startTime: 1630475277013213200,
            endTime: 1630475277013219600,
            parentSpanId: '25f7a5c6-7951-42d0-9ffb-f1545aac30ad',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '25f7a5c6-7951-42d0-9ffb-f1545aac30ad',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'ac8b0445-dcb1-4afe-b369-8d8070bb36f9',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6480,
          },
          {
            id: 'b0e4d1a0-7cba-40f8-a49a-1721111a72ac',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/onComplete',
            startTime: 1630475277012770000,
            endTime: 1630475277012772000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'b0e4d1a0-7cba-40f8-a49a-1721111a72ac',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2089,
          },
          {
            id: 'f7a7f134-1789-45cc-a91c-35ccf7fe6864',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/accept',
            startTime: 1630475277012465200,
            endTime: 1630475277012471600,
            parentSpanId: 'cda980bf-d37e-463f-b880-de594ed2d8b0',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'cda980bf-d37e-463f-b880-de594ed2d8b0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'f7a7f134-1789-45cc-a91c-35ccf7fe6864',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6488,
          },
          {
            id: '18547e8f-2c17-46fe-823b-6fc69ba85e40',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
            startTime: 1630475277012186400,
            endTime: 1630475277012220200,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'PEXPIRE',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PEXPIRE/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '18547e8f-2c17-46fe-823b-6fc69ba85e40',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 33809,
          },
          {
            id: 'ae205324-7b61-4388-a19e-7b76c0b82ce6',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/onComplete',
            startTime: 1630475277011320300,
            endTime: 1630475277011322400,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'ae205324-7b61-4388-a19e-7b76c0b82ce6',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2116,
          },
          {
            id: '27c52bc3-44b3-4663-ada8-c5c55c7247d7',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PUBLISH/accept',
            startTime: 1630475277014030800,
            endTime: 1630475277014037500,
            parentSpanId: 'b784152b-a6af-4d1e-bd45-983e8ce2525c',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PUBLISH/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'b784152b-a6af-4d1e-bd45-983e8ce2525c',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '27c52bc3-44b3-4663-ada8-c5c55c7247d7',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 6518,
          },
          {
            id: '68c36d9d-ea7d-47c1-90b1-d5ce8078a016',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/SADD/writeToChannelAndFlush',
            startTime: 1630475277012813600,
            endTime: 1630475277012859000,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'SADD',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/SADD/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '68c36d9d-ea7d-47c1-90b1-d5ce8078a016',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 45463,
          },
          {
            id: '47345af6-d734-45c0-b00e-f8e23cfe9348',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/accept',
            startTime: 1630475277006840600,
            endTime: 1630475277006851000,
            parentSpanId: '61296321-3b8c-47b2-849c-f43dd780f26b',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '61296321-3b8c-47b2-849c-f43dd780f26b',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '47345af6-d734-45c0-b00e-f8e23cfe9348',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 10271,
          },
          {
            id: 'b784152b-a6af-4d1e-bd45-983e8ce2525c',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/PUBLISH/onComplete',
            startTime: 1630475277014646300,
            endTime: 1630475277014648600,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/PUBLISH/onComplete',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: 'b784152b-a6af-4d1e-bd45-983e8ce2525c',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 2413,
          },
          {
            id: '9d5a0494-d3ae-40fc-a37f-9b9f0cc4d603',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/HMSET/writeToChannelAndFlush',
            startTime: 1630475277011828700,
            endTime: 1630475277011879200,
            parentSpanId: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_statement: 'HMSET',
              db_type: 'Redis',
              host: 'null:0',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/HMSET/writeToChannelAndFlush',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: '8e08a64c-e583-4a53-9537-dfc1817c33a1',
              peer_service: 'null:0',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '9d5a0494-d3ae-40fc-a37f-9b9f0cc4d603',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 50463,
          },
          {
            id: '07dac54d-67b4-4885-a8da-36344f3002b2',
            traceId: '4c263c83-6053-4392-9fd1-68fa69d360ef',
            operationName: 'Lettuce/GET/accept',
            startTime: 1630475277010156500,
            endTime: 1630475277010164200,
            parentSpanId: 'f1ee894c-2ab4-4e8f-ba75-2738a522c894',
            timestamp: 0,
            tags: {
              application_id: '6247',
              application_name: 'uc-deploy',
              cluster_name: 'terminus-dev',
              component: 'Redis',
              db_type: 'Redis',
              host: 'node-010000006220',
              host_ip: '10.0.6.220',
              operation_name: 'Lettuce/GET/accept',
              org_id: '100060',
              org_name: 'terminus',
              parent_span_id: 'f1ee894c-2ab4-4e8f-ba75-2738a522c894',
              project_id: '387',
              project_name: 'erda-project',
              runtime_id: '13804',
              runtime_name: 'develop',
              service_id: '6247_develop_uc',
              service_name: 'uc',
              span_id: '07dac54d-67b4-4885-a8da-36344f3002b2',
              span_layer: 'cache',
              terminus_key: 'z179399ebf5ab436c937479640aec4dfa',
              trace_id: '4c263c83-6053-4392-9fd1-68fa69d360ef',
              workspace: 'DEV',
            },
            duration: 7676,
          },
        ],
        duration: 9473158,
        serviceCount: 1,
        depth: 36,
        spanCount: 36,
      };
      const content = transformTrace(response);
      update({ traceDetailContent: content });
      return content;
    },
  },
});

export default trace;
